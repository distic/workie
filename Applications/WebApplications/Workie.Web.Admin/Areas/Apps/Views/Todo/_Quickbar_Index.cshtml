@inject IViewLocalizer Localizer

@model Workie.Web.Admin.Areas.Apps.Models.Todo.QuickbarControls.QuickbarControlsTodoViewModel

@{
    TimeSpan unixTime = DateTime.Now.ToUniversalTime() - new DateTime(1989, 7, 1, 0, 0, 0, DateTimeKind.Utc);
}

<div id="TaskViewTemplate" class="collapse"><partial name="QuickbarControls/_QuickbarControls_TaskView.cshtml" /></div>
<div id="SubtaskEditTemplate" class="collapse"><partial name="QuickbarControls/_QuickbarControls_SubtaskEdit.cshtml" /></div>
<div id="SubtaskViewTemplate" class="collapse"><partial name="QuickbarControls/_QuickbarControls_SubtaskView.cshtml" /></div>

<div role="tabpanel" class="tab-pane" id="qa-toDo">
    <div class="ms-quickbar-container ms-todo-list-container ms-scrollable ps">

        <form asp-area="Apps" asp-controller="Todo" asp-action="AddEditTask"
              method="post"
              data-ajax-mode="replace"
              data-ajax="true"
              data-ajax-begin="QuickbarTodoIndexModule.onAddEditTaskSubmitBegin"
              data-ajax-success="QuickbarTodoIndexModule.onAddEditTaskSubmitSuccess"
              data-ajax-failure="QuickbarTodoIndexModule.onAddEditTaskSubmitFailure">

            @Html.HiddenFor(model => model.Id)

            <div class="form-group mx-3 mt-0  fs-14 clearfix">
                <input type="text" class="form-control fs-14 float-left" id="task-block" name="Title" placeholder="@Localizer["Add Task Block"]" value="">
                <button type="submit" class="ms-btn-icon bg-primary float-right">
                    <i class="material-icons text-disabled">
                        @Localizer["add"]
                    </i>
                </button>
            </div>
        </form>

        <partial name="QuickbarControls/DataTable/_DataTable_Result.cshtml" />
        <ul class="ms-todo-list"></ul>
    </div>
</div>

<script type="text/javascript">

    function getDeleteTodoByIdUrl(id) {
        return '@Url.Action("DeleteTodoById", "Todo", new { Area = "Apps" })?id=' + id;
    }

    function getDeleteSubtaskUrl(taskId, subtaskId) {
        return '@Url.Action("DeleteSubtask", "Todo", new { Area = "Apps" })?taskId=' + taskId + '&subtaskId=' + subtaskId;
    }

    function getAddEditSubtaskUrl(taskId, subtaskId, name) {
        return '@Url.Action("AddEditSubtask", "Todo", new { Area = "Apps" })?taskId=' + taskId + '&subtaskId=' + subtaskId + '&name=' + name;
    }

</script>

